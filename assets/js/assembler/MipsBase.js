const registers={zero:0,at:1,v0:2,v1:3,a0:4,a1:5,a2:6,a3:7,t0:8,t1:9,t2:10,t3:11,t4:12,t5:13,t6:14,t7:15,s0:16,s1:17,s2:18,s3:19,s4:20,s5:21,s6:22,s7:23,t8:24,t9:25,k0:26,k1:27,gp:28,sp:29,fp:30,ra:31};function defaultSplit(t,s=!0){var e=t.split(",");s&&2===e.length&&(e=Array(e[0],e[0],e[1]));for(var i=0;i<e.length;i++)e[i]=e[i].trim().replace("$","");return e}function directiveSplit(t){for(var s=t.split(","),e=0;e<s.length;e++)s[e]=s[e].trim().replace("$","");return s}function loadSaveSplit(t){for(var s=t.split(","),e=s[1].split("("),i=[s[0],e[1].replace(")",""),e[0]],n=0;n<i.length;n++)i[n]=i[n].trim().replace("$","");return i}function processInput(t,s=0,e=0,i=0,n=!0){for(var r=Array(s+e),d=0;d<s;d++){var a=t[d];if(!(a in registers))throw new Error("Invalid register found.");r[d]=registers[a]}if(e>0){var o=t.length-1;if(""===t[o]){if(n)throw new Error("Missing immediate value.");return r}if(isNaN(parseInt(t[o]))){if(n)throw new Error("Missing or invalid immediate value.");return r}if(t[o]>i)throw new Error("Immediate value cannot be larger than 0x"+i.toString(16)+"("+i+")");r[o]=t[o]}return r}function threeRegisters(t){return processInput(defaultSplit(t),3)}function twoRegisters(t){return processInput(defaultSplit(t,compoundAssign=!1),2)}function moveProcess(t){var s=defaultSplit(t,compoundAssign=!1);return s.push("zero"),processInput(s,3)}function liProcess(t){var s=defaultSplit(t,compoundAssign=!1);return processInput(s=[s[0],"zero",s[1]],2,1,65535)}function twoRegisterAndImmediate(t){return processInput(defaultSplit(t),2,1,65535)}function twoRegisterAndImmSmall(t){return processInput(defaultSplit(t),2,1,31)}function oneRegisterAndImmediate(t){return processInput(defaultSplit(t,!1),1,1,65535)}function oneRegister(t){return processInput(defaultSplit(t,!1),1)}function syscallProcess(t){return processInput(defaultSplit(t,!1),0,1,1048575,!1)}function largeImmediate(t){return processInput(defaultSplit(t),0,1,67108863)}function loadSave(t){return processInput(loadSaveSplit(t),2,1,65535)}function loadSaveSmallImm(t){return processInput(loadSaveSplit(t),2,1,31)}function secondParamOn(t){return processInput(defaultSplit(t).slice(1),2)}function firstParam(t){return processInput(defaultSplit(t).slice(0,1),1)}function trapProcess(t){return processInput(defaultSplit(t),2,1,1023)}function syncProcess(t){return processInput(defaultSplit(t,!1),0,1,31,!1)}function shiftProcess(t){return processInput(defaultSplit(t,!1),2,1,31,!1)}function byteProcessor(t,s,e){for(var i=directiveSplit(t),n=[],r=0;r<i.length;r++){var d=i[r];if(""!==d){if(isNaN(parseInt(d)))throw new Error("Value must be an integer value.");if(d>e)throw new Error("Value cannot be larger than 0xFFFFFFFF (4294967295)");for(var a=[],o=0;o<s;o++){var l=(255&d).toString(16);l.length<2&&(l="0"+l),d>>=8,a.unshift(l)}n.push(a)}}return n}function wordProcess(t){return byteProcessor(t,4,4294967295)}function halfProcess(t){return byteProcessor(t,2,65535)}function byteProcess(t){return byteProcessor(t,1,255)}function emptyProcess(t){return[[]]}function asciiProcess(t){for(var s=t.split(""),e=[],i=0;i<s.length;i++)e.push(s[i].charCodeAt(0).toString(16));return[e]}function asciizProcess(t){var s=asciiProcess(t);return s.push("00"),[s]}class MipsInstruction{constructor(t,s=null,e=null,i=null,n=null){this.name=t,this.processorFn=s,this.instBytes=e,this.shifts=i,this.pseudoExpansion=n}}class MipsDirective{constructor(t,s){this.name=t,this.processorFn=s}}class MipsInstructions{constructor(t){switch(this.instructions={},this.directives={},t){case"4":this.add_ins("movn",threeRegisters,11,[11,21,16]),this.add_ins("movz",threeRegisters,10,[11,21,16]),this.add_ins("pref",loadSave,3422552064,[16,21,0]),this.add_ins("prefx",loadSaveSmallImm,1275068431,[11,21,16]);case"3":this.add_ins("dadd",threeRegisters,44,[11,21,16]),this.add_ins("daddu",threeRegisters,45,[11,21,16]),this.add_ins("daddi",twoRegisterAndImmediate,1610612736,[16,21,0]),this.add_ins("daddiu",twoRegisterAndImmediate,1677721600,[16,21,0]),this.add_ins("ddiv",twoRegisters,30,[21,16]),this.add_ins("ddivu",twoRegisters,31,[21,16]),this.add_ins("dmult",twoRegisters,28,[21,16]),this.add_ins("dmultu",twoRegisters,29,[21,16]),this.add_ins("dsll",shiftProcess,56,[11,16,6]),this.add_ins("dsll32",shiftProcess,60,[11,16,6]),this.add_ins("dsllv",threeRegisters,20,[11,16,21]),this.add_ins("dsra",shiftProcess,59,[11,16,6]),this.add_ins("dsra32",shiftProcess,63,[11,16,6]),this.add_ins("dsrav",threeRegisters,23,[11,16,21]),this.add_ins("dsrl",shiftProcess,58,[11,16,6]),this.add_ins("dsrl32",shiftProcess,62,[11,16,6]),this.add_ins("dsrlv",threeRegisters,22,[11,16,21]),this.add_ins("dsub",threeRegisters,46,[11,21,16]),this.add_ins("dsubu",threeRegisters,47,[11,21,16]),this.add_ins("ld",loadSave,3154116608,[16,21,0]),this.add_ins("ldl",loadSave,1744830464,[16,21,0]),this.add_ins("ldr",loadSave,1811939328,[16,21,0]),this.add_ins("lld",loadSave,3489660928,[16,21,0]),this.add_ins("lwu",loadSave,2617245696,[16,21,0]),this.add_ins("scd",loadSave,4026531840,[16,21,0]),this.add_ins("sd",loadSave,4227858432,[16,21,0]),this.add_ins("sdl",loadSave,2952790016,[16,21,0]),this.add_ins("sdr",loadSave,3019898880,[16,21,0]);case"2":this.add_ins("beql",twoRegisterAndImmediate,1342177280,[21,16,0]),this.add_ins("bgezl",oneRegisterAndImmediate,67305472,[21,0]),this.add_ins("bgezall",oneRegisterAndImmediate,68354048,[21,0]),this.add_ins("bgtzl",oneRegisterAndImmediate,1543503872,[21,0]),this.add_ins("blezl",oneRegisterAndImmediate,1476395008,[21,0]),this.add_ins("bltzall",oneRegisterAndImmediate,68288512,[21,0]),this.add_ins("bltzl",oneRegisterAndImmediate,67239936,[21,0]),this.add_ins("bnel",twoRegisterAndImmediate,1409286144,[21,16,0]),this.add_ins("ll",loadSave,3221225472,[16,21,0]),this.add_ins("sc",loadSave,3758096384,[16,21,0]),this.add_ins("teq",trapProcess,52,[21,16,6]),this.add_ins("teqi",oneRegisterAndImmediate,67895296,[21,0]),this.add_ins("tge",trapProcess,48,[21,16,6]),this.add_ins("tgei",oneRegisterAndImmediate,67633152,[21,0]),this.add_ins("tgeiu",oneRegisterAndImmediate,67698688,[21,0]),this.add_ins("tgeu",trapProcess,49,[21,16,6]),this.add_ins("tlti",oneRegisterAndImmediate,67764224,[21,0]),this.add_ins("tltiu",oneRegisterAndImmediate,67829760,[21,0]),this.add_ins("tne",trapProcess,54,[21,16,6]),this.add_ins("tnei",oneRegisterAndImmediate,68026368,[21,0]),this.add_ins("tlt",trapProcess,50,[21,16,6]),this.add_ins("tltu",trapProcess,51,[21,16,6]),this.add_ins("sync",syncProcess,15,[6]);case"1":this.add_ins("add",threeRegisters,32,[11,21,16]),this.add_ins("addi",twoRegisterAndImmediate,536870912,[16,21,0]),this.add_ins("addiu",twoRegisterAndImmediate,603979776,[16,21,0]),this.add_ins("addu",threeRegisters,33,[11,21,16],null),this.add_ins("and",threeRegisters,36,[11,21,16],null),this.add_ins("andi",twoRegisterAndImmediate,[16,21,0]),this.add_ins("beq",twoRegisterAndImmediate,268435456,[21,16,0]),this.add_ins("bgez",oneRegisterAndImmediate,67174400,[21,0]),this.add_ins("bgezal",oneRegisterAndImmediate,68222976,[21,0]),this.add_ins("bgtz",oneRegisterAndImmediate,469762048,[21,0]),this.add_ins("blez",oneRegisterAndImmediate,402653184,[21,0]),this.add_ins("bltz",oneRegisterAndImmediate,67108864,[21,0]),this.add_ins("bltzal",oneRegisterAndImmediate,68157440,[21,0]),this.add_ins("break",syscallProcess,13,[6]),this.add_ins("bne",twoRegisterAndImmediate,335544320,[21,16,0]),this.add_ins("div",twoRegisters,26,[21,16]),this.add_ins("divu",twoRegisters,27,[21,16]),this.add_ins("j",largeImmediate,134217728,[0]),this.add_ins("jal",largeImmediate,201326592,[0]),this.add_ins("jr",oneRegister,8,[21]),this.add_ins("lb",loadSave,2147483648,[16,21,0]),this.add_ins("lbu",loadSave,2415919104,[16,21,0]),this.add_ins("lh",loadSave,2214592512,[16,21,0]),this.add_ins("lhu",loadSave,2483027968,[16,21,0]),this.add_ins("li",liProcess,939524096,[16,21,0]),this.add_ins("lui",oneRegisterAndImmediate,1006632960,[16,0]),this.add_ins("lw",loadSave,2348810240,[16,21,0]),this.add_ins("lwl",loadSave,2281701376,[16,21,0]),this.add_ins("lwr",loadSave,2550136832,[16,21,0]),this.add_ins("move",[moveProcess],null,null,["or"]),this.add_ins("mfhi",oneRegister,16,[11]),this.add_ins("mflo",oneRegister,18,[11]),this.add_ins("mthi",oneRegister,17,[21]),this.add_ins("mtlo",oneRegister,19,[21]),this.add_ins("mul",[secondParamOn,firstParam],null,null,["multu","mflo"]),this.add_ins("mult",twoRegisters,24,[21,16]),this.add_ins("multu",twoRegisters,25,[21,16]),this.add_ins("nor",threeRegisters,39,[11,21,16]),this.add_ins("or",threeRegisters,37,[11,21,16]),this.add_ins("ori",twoRegisterAndImmediate,872415232,[16,21,0]),this.add_ins("sb",loadSave,2684354560,[16,21,0]),this.add_ins("sh",loadSave,2751463424,[16,21,0]),this.add_ins("sll",twoRegisterAndImmSmall,0,[11,16,6]),this.add_ins("sllv",threeRegisters,4,[11,16,21]),this.add_ins("slt",threeRegisters,42,[11,21,16]),this.add_ins("slti",twoRegisterAndImmediate,671088640,[16,21,0]),this.add_ins("sltiu",twoRegisterAndImmediate,738197504,[16,21,0]),this.add_ins("sltu",threeRegisters,43,[11,21,16]),this.add_ins("sra",twoRegisterAndImmSmall,3,[11,16,6]),this.add_ins("srl",twoRegisterAndImmSmall,2,[11,16,6]),this.add_ins("srlv",threeRegisters,6,[11,16,21]),this.add_ins("sub",threeRegisters,34,[11,21,16]),this.add_ins("subu",threeRegisters,35,[11,21,16]),this.add_ins("sw",loadSave,2885681152,[16,21,0]),this.add_ins("swl",loadSave,2818572288,[16,21,0]),this.add_ins("swr",loadSave,3087007744,[16,21,0]),this.add_ins("syscall",syscallProcess,12,[6]),this.add_ins("xor",threeRegisters,38,[11,21,16]),this.add_ins("xori",twoRegisterAndImmediate,939524096,[16,21,0])}this.add_directive(".word",wordProcess),this.add_directive(".half",halfProcess),this.add_directive(".byte",byteProcess),this.add_directive(".ascii",asciiProcess),this.add_directive(".asciiz",asciizProcess),this.add_directive(".globl",emptyProcess),this.add_directive(".text",emptyProcess)}add_ins(t,s,e=null,i=null,n=null){this.instructions[t]=new MipsInstruction(t,s,e,i,n)}add_directive(t,s){this.directives[t]=new MipsDirective(t,s)}is_instruction(t){return null!=this.instructions[t]}is_directive(t){return null!=this.directives[t]}findInstruction(t){var s=this.instructions[t];if(null==s)throw new Error("Instruction not found.");if(null!==s.pseudoExpansion){for(var e=[],i=0;i<s.pseudoExpansion.length;i++){var n=this.findInstruction(s.pseudoExpansion[i]);n[0].processorFn=s.processorFn[i],e=e.concat(n)}return e}return[s]}findDirective(t){var s=this.directives[t];if(null==s)throw new Error("Directive not found.");return[s]}find(t){return t.startsWith(".")?this.findDirective(t):this.findInstruction(t)}}class MipsParser{constructor(t){this.target=t,this.target_text=t.textContent}get bytes(){var t,s="";if(this.target_text.indexOf(" ")>0?(t=this.target_text.slice(0,this.target_text.indexOf(" ")).trim(),s=this.target_text.slice(this.target_text.indexOf(" ")+1)):t=this.target_text.trim(),t.startsWith("#")||t.endsWith(":"))return[];for(var e=mipsInstructions.find(t),i=[],n=0;n<e.length;n++){var r=this.createBytes(e[n],s);e[n]instanceof MipsInstruction?i.push(r):i=r}return i}createInstructionBytes(t,s){for(var e=[],i=t.instBytes,n=0;n<s.length;n++){var r=t.shifts[n];i+=a=s[n]<<r}for(var d=0;i>0||d<4;){var a;(a=(255&i).toString(16)).length<2&&(a="0"+a),i>>=8,e.unshift(a),d++}return e}createBytes(t,s){var e=t.processorFn(s);return t instanceof MipsInstruction?this.createInstructionBytes(t,e):t instanceof MipsDirective?e:void 0}}function syntaxHighlight(t){t.querySelectorAll("div").forEach(t=>{var s=t.querySelectorAll("span");0!=s.length&&(s[0].textContent.startsWith("#")?t.className="comment":s[0].textContent.endsWith(":")?t.className="label":s.forEach(t=>{var s=t.textContent.trim(),e="";mipsInstructions.is_instruction(s)?e="instruction":mipsInstructions.is_directive(s)?e="directive":s.replace("$","")in registers?e="register":" "==s[0]?e="space":isNaN(s)?s.endsWith(":")&&(e="label"):e="number",t.className=e}))})}function getParser(){return MipsParser}function loadMessage(){return".globl main\n.text\n\nmain:\n# Enter instructions here."}