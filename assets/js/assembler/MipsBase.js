const registers={zero:0,at:1,v0:2,v1:3,a0:4,a1:5,a2:6,a3:7,t0:8,t1:9,t2:10,t3:11,t4:12,t5:13,t6:14,t7:15,s0:16,s1:17,s2:18,s3:19,s4:20,s5:21,s6:22,s7:23,t8:24,t9:25,k0:26,k1:27,gp:28,sp:29,fp:30,ra:31};function defaultSplit(t,s=!0){var e=t.split(",");s&&2===e.length&&(e=Array(e[0],e[0],e[1]));for(var i=0;i<e.length;i++)e[i]=e[i].trim().replace("$","");return e}function directiveSplit(t){for(var s=t.split(","),e=0;e<s.length;e++)s[e]=s[e].trim().replace("$","");return s}function loadSaveSplit(t){for(var s=t.split(","),e=s[1].split("("),i=[s[0],e[1].replace(")",""),e[0]],n=0;n<i.length;n++)i[n]=i[n].trim().replace("$","");return i}function processInput(t,s=0,e=0,i=0,n=!0){for(var r=Array(s+e),a=0;a<s;a++){var d=t[a];if(!(d in registers))throw new Error("Invalid register found.");r[a]=registers[d]}if(e>0){var o=t.length-1;if(""===t[o]){if(n)throw new Error("Missing immediate value.");return r}if(isNaN(parseInt(t[o]))){if(n)throw new Error("Missing or invalid immediate value.");return r}if(t[o]>i)throw new Error("Immediate value cannot be larger than 0x"+i.toString(16)+"("+i+")");r[o]=t[o]}return r}function threeRegisters(t){return processInput(defaultSplit(t),3)}function twoRegisters(t){return processInput(defaultSplit(t,compoundAssign=!1),2)}function moveProcess(t){var s=defaultSplit(t,compoundAssign=!1);return s.push("zero"),processInput(s,3)}function liProcess(t){var s=defaultSplit(t,compoundAssign=!1);return processInput(s=[s[0],"zero",s[1]],2,1,65535)}function twoRegisterAndImmediate(t){return processInput(defaultSplit(t),2,1,65535)}function labelToInt(t,s,e){var i=t.findLabel(e);if(null==i)throw new Error('Label "'+e+'" not found.');var n=t.findByteDistance(s,i.element);if(0!=n%4)throw new Error("Branch to misaligned instruction.");if(4==n)throw new Error("Branching to the delay slot is not allowed.");return 0<n&&(n-=4),n/4}function twoRegisterAndImmediateOrLabel(t,s,e){var i=defaultSplit(e);return isNaN(i[2])&&(i[2]=labelToInt(t,s,i[2])),processInput(i,2,1,65535)}function twoRegisterAndImmSmall(t){return processInput(defaultSplit(t),2,1,31)}function oneRegisterAndImmediate(t){return processInput(defaultSplit(t,!1),1,1,65535)}function oneRegisterAndImmediateOrLabel(t,s,e){var i=defaultSplit(e,!1);return isNaN(i[1])&&(i[1]=labelToInt(t,s,i[1])),processInput(i,1,1,65535)}function oneRegister(t){return processInput(defaultSplit(t,!1),1)}function syscallProcess(t){return processInput(defaultSplit(t,!1),0,1,1048575,!1)}function largeImmediateOrLabel(t,s,e){var i=defaultSplit(e);return isNaN(i[0])&&(i[0]=labelToInt(t,s,i[0])),processInput(i,0,1,67108863)}function largeImmediate(t){return processInput(defaultSplit(t),0,1,67108863)}function loadSave(t){return processInput(loadSaveSplit(t),2,1,65535)}function loadSaveSmallImm(t){return processInput(loadSaveSplit(t),2,1,31)}function secondParamOn(t){return processInput(defaultSplit(t).slice(1),2)}function firstParam(t){return processInput(defaultSplit(t).slice(0,1),1)}function trapProcess(t){return processInput(defaultSplit(t),2,1,1023)}function syncProcess(t){return processInput(defaultSplit(t,!1),0,1,31,!1)}function shiftProcess(t){return processInput(defaultSplit(t,!1),2,1,31,!1)}function byteProcessor(t,s,e){for(var i=directiveSplit(t),n=[],r=0;r<i.length;r++){var a=i[r];if(""!==a){if(isNaN(parseInt(a)))throw new Error("Value must be an integer value.");if(a>e)throw new Error("Value cannot be larger than 0xFFFFFFFF (4294967295)");for(var d=[],o=0;o<s;o++){var l=(255&a).toString(16);l.length<2&&(l="0"+l),a>>=8,d.unshift(l)}n.push(d)}}return n}function wordProcess(t){return byteProcessor(t,4,4294967295)}function halfProcess(t){return byteProcessor(t,2,65535)}function byteProcess(t){return byteProcessor(t,1,255)}function emptyProcess(t){return[[]]}function asciiProcess(t){for(var s=t.split(""),e=[],i=0;i<s.length;i++)e.push(s[i].charCodeAt(0).toString(16));return[e]}function asciizProcess(t){var s=asciiProcess(t);return s.push("00"),[s]}class MipsInstruction{constructor(t,s=null,e=null,i=null,n=null,r=!1){this.name=t,this.processorFn=s,this.instBytes=e,this.shifts=i,this.pseudoExpansion=n,this.postProcess=r}}class MipsDirective{constructor(t,s){this.name=t,this.processorFn=s,this.postProcess=!1}}class MipsInstructions{constructor(t){switch(this.instructions={},this.directives={},t){case"4":this.add_ins("movn",threeRegisters,11,[11,21,16]),this.add_ins("movz",threeRegisters,10,[11,21,16]),this.add_ins("pref",loadSave,3422552064,[16,21,0]),this.add_ins("prefx",loadSaveSmallImm,1275068431,[11,21,16]);case"3":this.add_ins("dadd",threeRegisters,44,[11,21,16]),this.add_ins("daddu",threeRegisters,45,[11,21,16]),this.add_ins("daddi",twoRegisterAndImmediate,1610612736,[16,21,0]),this.add_ins("daddiu",twoRegisterAndImmediate,1677721600,[16,21,0]),this.add_ins("ddiv",twoRegisters,30,[21,16]),this.add_ins("ddivu",twoRegisters,31,[21,16]),this.add_ins("dmult",twoRegisters,28,[21,16]),this.add_ins("dmultu",twoRegisters,29,[21,16]),this.add_ins("dsll",shiftProcess,56,[11,16,6]),this.add_ins("dsll32",shiftProcess,60,[11,16,6]),this.add_ins("dsllv",threeRegisters,20,[11,16,21]),this.add_ins("dsra",shiftProcess,59,[11,16,6]),this.add_ins("dsra32",shiftProcess,63,[11,16,6]),this.add_ins("dsrav",threeRegisters,23,[11,16,21]),this.add_ins("dsrl",shiftProcess,58,[11,16,6]),this.add_ins("dsrl32",shiftProcess,62,[11,16,6]),this.add_ins("dsrlv",threeRegisters,22,[11,16,21]),this.add_ins("dsub",threeRegisters,46,[11,21,16]),this.add_ins("dsubu",threeRegisters,47,[11,21,16]),this.add_ins("ld",loadSave,3154116608,[16,21,0]),this.add_ins("ldl",loadSave,1744830464,[16,21,0]),this.add_ins("ldr",loadSave,1811939328,[16,21,0]),this.add_ins("lld",loadSave,3489660928,[16,21,0]),this.add_ins("lwu",loadSave,2617245696,[16,21,0]),this.add_ins("scd",loadSave,4026531840,[16,21,0]),this.add_ins("sd",loadSave,4227858432,[16,21,0]),this.add_ins("sdl",loadSave,2952790016,[16,21,0]),this.add_ins("sdr",loadSave,3019898880,[16,21,0]);case"2":this.add_ins("beql",twoRegisterAndImmediateOrLabel,1342177280,[21,16,0],null,!0),this.add_ins("bgezl",oneRegisterAndImmediateOrLabel,67305472,[21,0],null,!0),this.add_ins("bgezall",oneRegisterAndImmediateOrLabel,68354048,[21,0],null,!0),this.add_ins("bgtzl",oneRegisterAndImmediateOrLabel,1543503872,[21,0],null,!0),this.add_ins("blezl",oneRegisterAndImmediateOrLabel,1476395008,[21,0],null,!0),this.add_ins("bltzall",oneRegisterAndImmediateOrLabel,68288512,[21,0],null,!0),this.add_ins("bltzl",oneRegisterAndImmediateOrLabel,67239936,[21,0],null,!0),this.add_ins("bnel",twoRegisterAndImmediateOrLabel,1409286144,[21,16,0],null,!0),this.add_ins("ll",loadSave,3221225472,[16,21,0]),this.add_ins("sc",loadSave,3758096384,[16,21,0]),this.add_ins("teq",trapProcess,52,[21,16,6]),this.add_ins("teqi",oneRegisterAndImmediate,67895296,[21,0]),this.add_ins("tge",trapProcess,48,[21,16,6]),this.add_ins("tgei",oneRegisterAndImmediate,67633152,[21,0]),this.add_ins("tgeiu",oneRegisterAndImmediate,67698688,[21,0]),this.add_ins("tgeu",trapProcess,49,[21,16,6]),this.add_ins("tlti",oneRegisterAndImmediate,67764224,[21,0]),this.add_ins("tltiu",oneRegisterAndImmediate,67829760,[21,0]),this.add_ins("tne",trapProcess,54,[21,16,6]),this.add_ins("tnei",oneRegisterAndImmediate,68026368,[21,0]),this.add_ins("tlt",trapProcess,50,[21,16,6]),this.add_ins("tltu",trapProcess,51,[21,16,6]),this.add_ins("sync",syncProcess,15,[6]);case"1":this.add_ins("add",threeRegisters,32,[11,21,16]),this.add_ins("addi",twoRegisterAndImmediate,536870912,[16,21,0]),this.add_ins("addiu",twoRegisterAndImmediate,603979776,[16,21,0]),this.add_ins("addu",threeRegisters,33,[11,21,16]),this.add_ins("and",threeRegisters,36,[11,21,16]),this.add_ins("andi",twoRegisterAndImmediate,[16,21,0]),this.add_ins("beq",twoRegisterAndImmediateOrLabel,268435456,[21,16,0],null,!0),this.add_ins("bgez",oneRegisterAndImmediateOrLabel,67174400,[21,0],null,!0),this.add_ins("bgezal",oneRegisterAndImmediateOrLabel,68222976,[21,0],null,!0),this.add_ins("bgtz",oneRegisterAndImmediateOrLabel,469762048,[21,0],null,!0),this.add_ins("blez",oneRegisterAndImmediateOrLabel,402653184,[21,0],null,!0),this.add_ins("bltz",oneRegisterAndImmediateOrLabel,67108864,[21,0],null,!0),this.add_ins("bltzal",oneRegisterAndImmediateOrLabel,68157440,[21,0],null,!0),this.add_ins("break",syscallProcess,13,[6]),this.add_ins("bne",twoRegisterAndImmediateOrLabel,335544320,[21,16,0],null,!0),this.add_ins("div",twoRegisters,26,[21,16]),this.add_ins("divu",twoRegisters,27,[21,16]),this.add_ins("j",largeImmediateOrLabel,134217728,[0],null,!0),this.add_ins("jal",largeImmediate,201326592,[0]),this.add_ins("jr",oneRegister,8,[21]),this.add_ins("lb",loadSave,2147483648,[16,21,0]),this.add_ins("lbu",loadSave,2415919104,[16,21,0]),this.add_ins("lh",loadSave,2214592512,[16,21,0]),this.add_ins("lhu",loadSave,2483027968,[16,21,0]),this.add_ins("li",liProcess,939524096,[16,21,0]),this.add_ins("lui",oneRegisterAndImmediate,1006632960,[16,0]),this.add_ins("lw",loadSave,2348810240,[16,21,0]),this.add_ins("lwl",loadSave,2281701376,[16,21,0]),this.add_ins("lwr",loadSave,2550136832,[16,21,0]),this.add_ins("move",[moveProcess],null,null,["or"]),this.add_ins("mfhi",oneRegister,16,[11]),this.add_ins("mflo",oneRegister,18,[11]),this.add_ins("mthi",oneRegister,17,[21]),this.add_ins("mtlo",oneRegister,19,[21]),this.add_ins("mul",[secondParamOn,firstParam],null,null,["multu","mflo"]),this.add_ins("mult",twoRegisters,24,[21,16]),this.add_ins("multu",twoRegisters,25,[21,16]),this.add_ins("nor",threeRegisters,39,[11,21,16]),this.add_ins("or",threeRegisters,37,[11,21,16]),this.add_ins("ori",twoRegisterAndImmediate,872415232,[16,21,0]),this.add_ins("sb",loadSave,2684354560,[16,21,0]),this.add_ins("sh",loadSave,2751463424,[16,21,0]),this.add_ins("sll",twoRegisterAndImmSmall,0,[11,16,6]),this.add_ins("sllv",threeRegisters,4,[11,16,21]),this.add_ins("slt",threeRegisters,42,[11,21,16]),this.add_ins("slti",twoRegisterAndImmediate,671088640,[16,21,0]),this.add_ins("sltiu",twoRegisterAndImmediate,738197504,[16,21,0]),this.add_ins("sltu",threeRegisters,43,[11,21,16]),this.add_ins("sra",twoRegisterAndImmSmall,3,[11,16,6]),this.add_ins("srl",twoRegisterAndImmSmall,2,[11,16,6]),this.add_ins("srlv",threeRegisters,6,[11,16,21]),this.add_ins("sub",threeRegisters,34,[11,21,16]),this.add_ins("subu",threeRegisters,35,[11,21,16]),this.add_ins("sw",loadSave,2885681152,[16,21,0]),this.add_ins("swl",loadSave,2818572288,[16,21,0]),this.add_ins("swr",loadSave,3087007744,[16,21,0]),this.add_ins("syscall",syscallProcess,12,[6]),this.add_ins("xor",threeRegisters,38,[11,21,16]),this.add_ins("xori",twoRegisterAndImmediate,939524096,[16,21,0])}this.add_directive(".word",wordProcess),this.add_directive(".half",halfProcess),this.add_directive(".byte",byteProcess),this.add_directive(".ascii",asciiProcess),this.add_directive(".asciiz",asciizProcess),this.add_directive(".globl",emptyProcess),this.add_directive(".text",emptyProcess)}add_ins(t,s,e=null,i=null,n=null,r=!1){this.instructions[t]=new MipsInstruction(t,s,e,i,n,r)}add_directive(t,s){this.directives[t]=new MipsDirective(t,s)}is_instruction(t){return null!=this.instructions[t]}is_directive(t){return null!=this.directives[t]}findInstruction(t){var s=this.instructions[t];if(null==s)throw new Error("Instruction not found.");if(null!==s.pseudoExpansion){for(var e=[],i=0;i<s.pseudoExpansion.length;i++){var n=this.findInstruction(s.pseudoExpansion[i]);n[0].processorFn=s.processorFn[i],e=e.concat(n)}return e}return[s]}findDirective(t){var s=this.directives[t];if(null==s)throw new Error("Directive not found.");return[s]}find(t){return t.startsWith(".")?this.findDirective(t):this.findInstruction(t)}}class MipsParser{constructor(t){this.full_instruction=t.toLowerCase(),this.instruction="",this.parameters="",this.instruction_match=null}findInstruction(){null==this.instruction_match&&(this.instruction_match=null,this.full_instruction.indexOf(" ")>0?(this.instruction=this.full_instruction.slice(0,this.full_instruction.indexOf(" ")).trim(),this.parameters=this.full_instruction.slice(this.full_instruction.indexOf(" ")+1)):this.instruction=this.full_instruction.trim(),this.instruction_match=mipsInstructions.find(this.instruction))}get shouldPostProcess(){for(var t=0;t<this.instruction_match.length;t++)if(this.instruction_match[t].postProcess)return!0;return!1}get bytes(){for(var t=[],s=0;s<this.instruction_match.length;s++){var e=this.createBytes(this.instruction_match[s],this.parameters);this.instruction_match[s]instanceof MipsInstruction?t.push(e):t=e}return t}postProcessBytes(t,s){for(var e=[],i=0;i<this.instruction_match.length;i++){var n=this.createBytes(this.instruction_match[i],this.parameters,t,s);this.instruction_match[i]instanceof MipsInstruction?e.push(n):e=n}return e}createBytes(t,s,e=null,i=null){var n;return n=null!=e&&null!=i?t.processorFn(e,i,s):t.processorFn(s),t instanceof MipsInstruction?this.createInstructionBytes(t,n):t instanceof MipsDirective?n:void 0}createInstructionBytes(t,s){for(var e=[],i=t.instBytes,n=0;n<s.length;n++){var r=t.shifts[n];i+=d=s[n]<<r}for(var a=0;i>0||a<4;){var d;(d=(255&i).toString(16)).length<2&&(d="0"+d),i>>=8,e.unshift(d),a++}return e}}function syntaxHighlight(t){t.querySelectorAll("div").forEach(t=>{var s=t.querySelectorAll("span");if(""===t.textContent.trim()?t.className="emtpy-line":t.className="",0==s.length)return""===t.textContent.trim()?void(t.className="emtpy-line"):void(t.className="");s[0].textContent.startsWith("#")?t.className="comment":s[0].textContent.endsWith(":")?t.className="label":s.forEach(s=>{var e=s.textContent.trim().toLowerCase();mipsInstructions.is_instruction(e)?(s.className="ins",t.className="instruction"):mipsInstructions.is_directive(e)?(s.className="dir",t.className="directive"):e.replace("$","")in registers?s.className="register":" "==e[0]?t.className="space":e.endsWith(":")?t.className="label":isNaN(e)||""===e?s.className="":s.className="number"})})}function getParser(){return MipsParser}function loadMessage(){return".globl main\n.text\n\nmain:\n# Enter instructions here.\n"}